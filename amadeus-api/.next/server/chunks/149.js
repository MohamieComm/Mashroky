"use strict";exports.id=149,exports.ids=[149],exports.modules={6149:(t,e,s)=>{s.d(e,{G:()=>S,e:()=>$});class i{constructor(t){this.token=null,this.config=t}get tokenUrl(){let t=this.config.baseUrl||"https://test.api.amadeus.com";return`${t}/v1/security/oauth2/token`}isTokenValid(){return!!this.token&&Date.now()/1e3<this.token._fetched_at+this.token.expires_in-60}async getToken(){return this.isTokenValid()?this.token.access_token:this.fetchToken()}async fetchToken(){let t=new URLSearchParams({grant_type:"client_credentials",client_id:this.config.clientId,client_secret:this.config.clientSecret}),e=await fetch(this.tokenUrl,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:t.toString()});if(!e.ok){let t=await e.text();throw new n(`OAuth2 token request failed (${e.status}): ${t}`)}let s=await e.json();return this.token={access_token:s.access_token,token_type:s.token_type,expires_in:s.expires_in,_fetched_at:Date.now()/1e3},this.token.access_token}invalidate(){this.token=null}}class n extends Error{constructor(t){super(t),this.name="AmadeusAuthError"}}class r extends Error{constructor(t,e){super(`Amadeus API Error (${t}): ${e.map(t=>`[${t.code}] ${t.title}: ${t.detail??""}`).join("; ")}`),this.name="AmadeusApiError",this.status=t,this.errors=e}}class c{constructor(t){this.baseUrl=t.baseUrl||"https://test.api.amadeus.com",this.timeout=t.timeout||3e4,this.tokenManager=new i(t)}async get(t,e,s){let i=this.buildUrl(t,e,s);return this.request("GET",i)}async post(t,e,s,i){let n=this.buildUrl(t,s,i);return this.request("POST",n,e)}async postAsGet(t,e,s,i){let n=this.buildUrl(t,s,i);return this.request("POST",n,e,{"X-HTTP-Method-Override":"GET"})}async delete(t,e){let s=this.buildUrl(t,void 0,e);return this.request("DELETE",s)}buildUrl(t,e,s){let i=s||"",n=new URL(t.startsWith("/")?`${i}${t}`:`${i}/${t}`,this.baseUrl);if(e)for(let[t,s]of Object.entries(e))void 0!==s&&(Array.isArray(s)?s.forEach(e=>n.searchParams.append(t,String(e))):n.searchParams.set(t,String(s)));return n.toString()}async request(t,e,s,i,c=0){let o=await this.tokenManager.getToken(),l={Authorization:`Bearer ${o}`,Accept:"application/vnd.amadeus+json, application/json",...i};s&&(l["Content-Type"]="application/vnd.amadeus+json");let h=new AbortController,u=setTimeout(()=>h.abort(),this.timeout);try{let n=await fetch(e,{method:t,headers:l,body:s?JSON.stringify(s):void 0,signal:h.signal});if(clearTimeout(u),429===n.status&&c<2){let r=parseInt(n.headers.get("Retry-After")||"1",10);return await a(1e3*r),this.request(t,e,s,i,c+1)}if(n.status>=500&&c<2)return await a(1e3*(c+1)),this.request(t,e,s,i,c+1);if(401===n.status&&0===c)return this.tokenManager.invalidate(),this.request(t,e,s,i,1);let o=await n.json().catch(()=>null);if(!n.ok){let t=o?.errors||[{status:n.status,code:n.status,title:n.statusText,detail:""}];throw new r(n.status,t)}return o}catch(o){if(clearTimeout(u),o instanceof r||o instanceof n)throw o;if(o instanceof DOMException&&"AbortError"===o.name)throw Error(`Amadeus API request timed out after ${this.timeout}ms: ${t} ${e}`);if(c<2)return await a(1e3*(c+1)),this.request(t,e,s,i,c+1);throw o}}}function a(t){return new Promise(e=>setTimeout(e,t))}class o{constructor(t){this.client=new c(t),this.shopping=new l(this.client),this.booking=new f(this.client),this.referenceData=new w(this.client),this.schedule=new A(this.client),this.travel=new T(this.client),this.analytics=new E(this.client)}}class l{constructor(t){this.client=t,this.flightOffers=new h(t),this.hotelOffers=new d(t),this.activities=new g(t),this.transferOffers=new p(t),this.seatMaps=new u(t)}}class h{constructor(t){this.client=t}async search(t){return this.client.get("/v2/shopping/flight-offers",t)}async pricing(t,e){return this.client.postAsGet("/v1/shopping/flight-offers/pricing",{data:t},e)}async availability(t){return this.client.postAsGet("/v1/shopping/availability/flight-availabilities",{data:t})}async cheapestDates(t){return this.client.get("/v1/shopping/flight-dates",t)}async inspirationSearch(t){return this.client.get("/v1/shopping/flight-destinations",t)}async upsell(t){return this.client.postAsGet("/v1/shopping/flight-offers/upselling",t)}}class u{constructor(t){this.client=t}async get(t){return this.client.get("/v1/shopping/seatmaps",t)}async post(t){return this.client.postAsGet("/v1/shopping/seatmaps",t)}}class d{constructor(t){this.client=t}async byCity(t){return this.client.get("/v1/reference-data/locations/hotels/by-city",t)}async byGeocode(t){return this.client.get("/v1/reference-data/locations/hotels/by-geocode",t)}async byHotelIds(t){return this.client.get("/v1/reference-data/locations/hotels/by-hotels",{hotelIds:t.hotelIds.join(",")})}async search(t){let{hotelIds:e,...s}=t;return this.client.get("/v3/shopping/hotel-offers",{hotelIds:e.join(","),...s})}async autocomplete(t){let{subType:e,...s}=t;return this.client.get("/v1/reference-data/locations/hotels/autocomplete",{subType:e.join(","),...s})}async sentiments(t){return this.client.get("/v2/e-reputation/hotel-sentiments",{hotelIds:t.hotelIds.join(",")})}}class p{constructor(t){this.client=t}async search(t){return this.client.post("/v1/shopping/transfer-offers",t)}}class g{constructor(t){this.client=t}async byGeocode(t){return this.client.get("/v1/shopping/activities",t)}async bySquare(t){return this.client.get("/v1/shopping/activities/by-square",t)}async get(t){return this.client.get(`/v1/shopping/activities/${t}`)}}class f{constructor(t){this.client=t,this.flightOrders=new y(t),this.hotelOrders=new v(t),this.transferOrders=new m(t)}}class y{constructor(t){this.client=t}async create(t){return this.client.post("/v1/booking/flight-orders",t)}async get(t){return this.client.get(`/v1/booking/flight-orders/${t}`)}async cancel(t){return this.client.delete(`/v1/booking/flight-orders/${t}`)}}class v{constructor(t){this.client=t}async create(t){return this.client.post("/v2/booking/hotel-orders",t)}}class m{constructor(t){this.client=t}async create(t,e){return this.client.post(`/v1/ordering/transfer-orders?offerId=${t}`,e)}async cancel(t,e){return this.client.post(`/v1/ordering/transfer-orders/${t}/transfers/cancellation`,{data:{confirmNbr:e}})}}class w{constructor(t){this.client=t,this.locations=new k(t),this.airlines=new b(t)}}class k{constructor(t){this.client=t}async search(t){let{subType:e,...s}=t;return this.client.get("/v1/reference-data/locations",{subType:e.join(","),...s})}async get(t){return this.client.get(`/v1/reference-data/locations/${t}`)}async cities(t){let{include:e,...s}=t;return this.client.get("/v1/reference-data/locations/cities",{include:e?.join(","),...s})}async recommended(t){return this.client.get("/v1/reference-data/recommended-locations",t)}}class b{constructor(t){this.client=t}async get(t){return this.client.get("/v1/reference-data/airlines",t)}async destinations(t){return this.client.get("/v1/airline/destinations",t)}async airportRoutes(t){return this.client.get("/v1/airport/direct-destinations",t)}}class A{constructor(t){this.client=t}async flightStatus(t){return this.client.get("/v2/schedule/flights",t)}async checkinLinks(t){return this.client.get("/v2/reference-data/urls/checkin-links",t)}}class T{constructor(t){this.client=t}async recommendations(t){return this.client.get("/v1/reference-data/recommended-locations",t)}}class E{constructor(t){this.client=t}async busiestPeriod(t){return this.client.get("/v1/travel/analytics/air-traffic/busiest-period",t)}async mostTraveled(t){return this.client.get("/v1/travel/analytics/air-traffic/traveled",t)}async mostBooked(t){return this.client.get("/v1/travel/analytics/air-traffic/booked",t)}}let _=null;function S(){if(_)return _;let t={clientId:process.env.AMADEUS_CLIENT_ID,clientSecret:process.env.AMADEUS_CLIENT_SECRET,baseUrl:process.env.AMADEUS_BASE_URL||"https://test.api.amadeus.com",timeout:3e4};if(!t.clientId||!t.clientSecret)throw Error("Missing AMADEUS_CLIENT_ID or AMADEUS_CLIENT_SECRET environment variables");return _=new o(t)}function $(){_=null}}};