(()=>{var e={};e.id=3,e.ids=[3],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},875:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>i.a,__next_app__:()=>h,originalPathname:()=>x,pages:()=>o,routeModule:()=>m,tree:()=>c}),t(8748),t(1506),t(5866);var a=t(3191),r=t(8716),l=t(7922),i=t.n(l),d=t(5231),n={};for(let e in d)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(n[e]=()=>d[e]);t.d(s,n);let c=["",{children:["admin",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,8748)),"C:\\Users\\ishou\\Desktop\\MashroukGit\\Tmahshruk\\CleanMashroky\\amadeus-api\\app\\admin\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,1506)),"C:\\Users\\ishou\\Desktop\\MashroukGit\\Tmahshruk\\CleanMashroky\\amadeus-api\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,5866,23)),"next/dist/client/components/not-found-error"]}],o=["C:\\Users\\ishou\\Desktop\\MashroukGit\\Tmahshruk\\CleanMashroky\\amadeus-api\\app\\admin\\page.tsx"],x="/admin/page",h={require:t,loadChunk:()=>Promise.resolve()},m=new a.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/admin/page",pathname:"/admin",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},7563:(e,s,t)=>{Promise.resolve().then(t.bind(t,8381))},8591:(e,s,t)=>{Promise.resolve().then(t.t.bind(t,9404,23))},9362:(e,s,t)=>{Promise.resolve().then(t.t.bind(t,2994,23)),Promise.resolve().then(t.t.bind(t,6114,23)),Promise.resolve().then(t.t.bind(t,9727,23)),Promise.resolve().then(t.t.bind(t,9671,23)),Promise.resolve().then(t.t.bind(t,1868,23)),Promise.resolve().then(t.t.bind(t,4759,23))},8381:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>i});var a=t(326),r=t(7577),l=t(7863);function i(){let[e,s]=(0,r.useState)("overview"),[t,i]=(0,r.useState)(null),[d,n]=(0,r.useState)([]),[c,o]=(0,r.useState)([]),[x,h]=(0,r.useState)([]),[m,p]=(0,r.useState)(null),[u,g]=(0,r.useState)(!1),[b,y]=(0,r.useState)(""),j=()=>({Authorization:`Bearer ${localStorage.getItem("admin_token")||""}`,"Content-Type":"application/json"}),N=async e=>{let s=await fetch(`/api/admin/${e}`,{headers:j()});if(!s.ok)throw Error(`Failed to fetch ${e}`);return s.json()},f=async e=>{g(!0),y("");try{switch(e){case"overview":let s=await N("stats");i(s.data);break;case"bookings":let t=await N("bookings");n(t.data||[]);break;case"users":let a=await N("users");o(a.data||[]);break;case"logs":let r=await N("logs");h(r.data||[]);break;case"config":let l=await N("config");p(l.data||{})}}catch(e){y(e.message)}finally{g(!1)}},v=async(e,s)=>{try{await fetch("/api/admin/users",{method:"PUT",headers:j(),body:JSON.stringify({userId:e,newRole:s})}),f("users")}catch(e){y(e.message)}},w=async()=>{try{await fetch("/api/admin/config",{method:"PUT",headers:j(),body:JSON.stringify(m)}),alert("تم حفظ الإعدادات بنجاح")}catch(e){y(e.message)}},D={confirmed:"bg-green-100 text-green-700",pending:"bg-yellow-100 text-yellow-700",cancelled:"bg-red-100 text-red-700",failed:"bg-gray-100 text-gray-700"},k={confirmed:"مؤكد",pending:"قيد الانتظار",cancelled:"ملغي",failed:"فشل"},_={flight:"✈️ طيران",hotel:"\uD83C\uDFE8 فندق",transfer:"\uD83D\uDE97 نقل",activity:"\uD83C\uDFAF نشاط"},C={user:"مستخدم",admin:"مشرف",super_admin:"مشرف عام"};return(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50",dir:"rtl",children:[a.jsx("div",{className:"bg-gradient-to-l from-gray-900 to-gray-800 text-white py-6 px-4",children:(0,a.jsxs)("div",{className:"max-w-7xl mx-auto",children:[a.jsx("h1",{className:"text-2xl font-bold",children:"\uD83D\uDEE1️ لوحة التحكم — مشروك"}),a.jsx("p",{className:"text-gray-400 text-sm mt-1",children:"إدارة الحجوزات والمستخدمين و Amadeus API"})]})}),(0,a.jsxs)("div",{className:"max-w-7xl mx-auto px-4 py-6",children:[a.jsx("div",{className:"flex gap-2 mb-6 overflow-x-auto pb-2",children:[{id:"overview",label:"نظرة عامة",icon:"\uD83D\uDCCA"},{id:"bookings",label:"الحجوزات",icon:"\uD83D\uDCCB"},{id:"users",label:"المستخدمين",icon:"\uD83D\uDC65"},{id:"logs",label:"سجل API",icon:"\uD83D\uDCDD"},{id:"config",label:"الإعدادات",icon:"⚙️"}].map(t=>(0,a.jsxs)("button",{onClick:()=>s(t.id),className:`px-5 py-2.5 rounded-lg font-medium whitespace-nowrap transition-all ${e===t.id?"bg-gray-900 text-white shadow-lg":"bg-white text-gray-600 hover:bg-gray-100 shadow"}`,children:[t.icon," ",t.label]},t.id))}),b&&(0,a.jsxs)("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm",children:["⚠️ ",b]}),u&&a.jsx("div",{className:"flex items-center justify-center py-12",children:a.jsx("div",{className:"animate-spin h-8 w-8 border-4 border-gray-300 rounded-full border-t-gray-800"})}),!u&&"overview"===e&&t&&(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[(0,a.jsxs)("div",{className:"bg-white rounded-xl shadow p-5",children:[a.jsx("div",{className:"text-sm text-gray-500 mb-1",children:"إجمالي الحجوزات"}),a.jsx("div",{className:"text-3xl font-bold",children:t.totalBookings})]}),(0,a.jsxs)("div",{className:"bg-white rounded-xl shadow p-5",children:[a.jsx("div",{className:"text-sm text-gray-500 mb-1",children:"الإيرادات"}),a.jsx("div",{className:"text-3xl font-bold text-green-700",children:(0,l.T4)(t.totalRevenue)})]}),(0,a.jsxs)("div",{className:"bg-white rounded-xl shadow p-5",children:[a.jsx("div",{className:"text-sm text-gray-500 mb-1",children:"المستخدمين"}),a.jsx("div",{className:"text-3xl font-bold",children:t.totalUsers})]}),(0,a.jsxs)("div",{className:"bg-white rounded-xl shadow p-5",children:[a.jsx("div",{className:"text-sm text-gray-500 mb-1",children:"استدعاءات API"}),a.jsx("div",{className:"text-3xl font-bold",children:t.apiCalls})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{className:"bg-white rounded-xl shadow p-5",children:[a.jsx("div",{className:"text-sm text-gray-500 mb-1",children:"متوسط وقت الاستجابة"}),(0,a.jsxs)("div",{className:"text-2xl font-bold",children:[t.avgResponseTime," ms"]})]}),(0,a.jsxs)("div",{className:"bg-white rounded-xl shadow p-5",children:[a.jsx("div",{className:"text-sm text-gray-500 mb-1",children:"نسبة الأخطاء"}),(0,a.jsxs)("div",{className:`text-2xl font-bold ${t.errorRate>10?"text-red-600":"text-green-600"}`,children:[t.errorRate,"%"]})]}),(0,a.jsxs)("div",{className:"bg-white rounded-xl shadow p-5",children:[a.jsx("div",{className:"text-sm text-gray-500 mb-1",children:"المشرفين"}),a.jsx("div",{className:"text-2xl font-bold",children:t.adminUsers})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"bg-white rounded-xl shadow p-5",children:[a.jsx("h3",{className:"font-bold mb-3",children:"حسب النوع"}),Object.entries(t.bookingsByType).map(([e,s])=>(0,a.jsxs)("div",{className:"flex justify-between py-1",children:[a.jsx("span",{children:_[e]||e}),a.jsx("span",{className:"font-bold",children:s})]},e))]}),(0,a.jsxs)("div",{className:"bg-white rounded-xl shadow p-5",children:[a.jsx("h3",{className:"font-bold mb-3",children:"حسب الحالة"}),Object.entries(t.bookingsByStatus).map(([e,s])=>(0,a.jsxs)("div",{className:"flex justify-between py-1",children:[a.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${D[e]||""}`,children:k[e]||e}),a.jsx("span",{className:"font-bold",children:s})]},e))]})]})]}),!u&&"bookings"===e&&a.jsx("div",{className:"bg-white rounded-xl shadow overflow-hidden",children:a.jsx("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"w-full text-sm",children:[a.jsx("thead",{className:"bg-gray-50",children:(0,a.jsxs)("tr",{children:[a.jsx("th",{className:"px-4 py-3 text-right",children:"رقم الحجز"}),a.jsx("th",{className:"px-4 py-3 text-right",children:"النوع"}),a.jsx("th",{className:"px-4 py-3 text-right",children:"المستخدم"}),a.jsx("th",{className:"px-4 py-3 text-right",children:"المبلغ"}),a.jsx("th",{className:"px-4 py-3 text-right",children:"الحالة"}),a.jsx("th",{className:"px-4 py-3 text-right",children:"التاريخ"})]})}),(0,a.jsxs)("tbody",{className:"divide-y",children:[d.map(e=>(0,a.jsxs)("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-4 py-3 font-mono text-xs",children:e.id.substring(0,8)}),a.jsx("td",{className:"px-4 py-3",children:_[e.booking_type]||e.booking_type}),a.jsx("td",{className:"px-4 py-3",children:e.profiles?.full_name||e.profiles?.email||"مجهول"}),a.jsx("td",{className:"px-4 py-3 font-bold",children:e.total_amount?(0,l.T4)(e.total_amount,e.currency):"—"}),a.jsx("td",{className:"px-4 py-3",children:a.jsx("span",{className:`px-2 py-1 rounded text-xs ${D[e.status]||""}`,children:k[e.status]||e.status})}),a.jsx("td",{className:"px-4 py-3 text-xs text-gray-500",children:new Date(e.created_at).toLocaleDateString("ar-SA")})]},e.id)),0===d.length&&a.jsx("tr",{children:a.jsx("td",{colSpan:6,className:"px-4 py-8 text-center text-gray-400",children:"لا توجد حجوزات"})})]})]})})}),!u&&"users"===e&&a.jsx("div",{className:"bg-white rounded-xl shadow overflow-hidden",children:a.jsx("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"w-full text-sm",children:[a.jsx("thead",{className:"bg-gray-50",children:(0,a.jsxs)("tr",{children:[a.jsx("th",{className:"px-4 py-3 text-right",children:"الاسم"}),a.jsx("th",{className:"px-4 py-3 text-right",children:"البريد"}),a.jsx("th",{className:"px-4 py-3 text-right",children:"الدور"}),a.jsx("th",{className:"px-4 py-3 text-right",children:"تاريخ التسجيل"}),a.jsx("th",{className:"px-4 py-3 text-right",children:"إجراء"})]})}),a.jsx("tbody",{className:"divide-y",children:c.map(e=>(0,a.jsxs)("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-4 py-3",children:e.full_name||"—"}),a.jsx("td",{className:"px-4 py-3 text-sm",dir:"ltr",children:e.email}),a.jsx("td",{className:"px-4 py-3",children:a.jsx("span",{className:`px-2 py-1 rounded text-xs ${"super_admin"===e.role?"bg-purple-100 text-purple-700":"admin"===e.role?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-700"}`,children:C[e.role]})}),a.jsx("td",{className:"px-4 py-3 text-xs text-gray-500",children:new Date(e.created_at).toLocaleDateString("ar-SA")}),a.jsx("td",{className:"px-4 py-3",children:(0,a.jsxs)("select",{value:e.role,onChange:s=>v(e.id,s.target.value),className:"text-xs border rounded px-2 py-1",children:[a.jsx("option",{value:"user",children:"مستخدم"}),a.jsx("option",{value:"admin",children:"مشرف"}),a.jsx("option",{value:"super_admin",children:"مشرف عام"})]})})]},e.id))})]})})}),!u&&"logs"===e&&a.jsx("div",{className:"bg-white rounded-xl shadow overflow-hidden",children:a.jsx("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"w-full text-sm",children:[a.jsx("thead",{className:"bg-gray-50",children:(0,a.jsxs)("tr",{children:[a.jsx("th",{className:"px-4 py-3 text-right",children:"الوقت"}),a.jsx("th",{className:"px-4 py-3 text-right",children:"الطريقة"}),a.jsx("th",{className:"px-4 py-3 text-right",children:"النقطة"}),a.jsx("th",{className:"px-4 py-3 text-right",children:"الحالة"}),a.jsx("th",{className:"px-4 py-3 text-right",children:"الزمن"}),a.jsx("th",{className:"px-4 py-3 text-right",children:"خطأ"})]})}),(0,a.jsxs)("tbody",{className:"divide-y",children:[x.map(e=>(0,a.jsxs)("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-4 py-3 text-xs text-gray-500",children:new Date(e.created_at).toLocaleString("ar-SA")}),a.jsx("td",{className:"px-4 py-3",children:a.jsx("span",{className:`px-2 py-0.5 rounded text-xs font-mono ${"GET"===e.method?"bg-green-100 text-green-700":"POST"===e.method?"bg-blue-100 text-blue-700":"DELETE"===e.method?"bg-red-100 text-red-700":"bg-gray-100"}`,children:e.method})}),a.jsx("td",{className:"px-4 py-3 font-mono text-xs",dir:"ltr",children:e.endpoint}),a.jsx("td",{className:"px-4 py-3",children:a.jsx("span",{className:`font-mono text-xs ${400>(e.response_status||0)?"text-green-600":"text-red-600"}`,children:e.response_status})}),(0,a.jsxs)("td",{className:"px-4 py-3 text-xs",children:[e.response_time_ms,"ms"]}),a.jsx("td",{className:"px-4 py-3 text-xs text-red-500 max-w-[200px] truncate",children:e.error_message||"—"})]},e.id)),0===x.length&&a.jsx("tr",{children:a.jsx("td",{colSpan:6,className:"px-4 py-8 text-center text-gray-400",children:"لا توجد سجلات"})})]})]})})}),!u&&"config"===e&&m&&(0,a.jsxs)("div",{className:"bg-white rounded-xl shadow p-6 space-y-6",children:[a.jsx("h3",{className:"text-xl font-bold",children:"⚙️ إعدادات Amadeus API"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Client ID"}),a.jsx("input",{type:"text",value:m.client_id||"",onChange:e=>p({...m,client_id:e.target.value}),className:"w-full px-4 py-3 border border-gray-300 rounded-lg font-mono",dir:"ltr"})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Client Secret"}),a.jsx("input",{type:"password",value:m.client_secret||"",onChange:e=>p({...m,client_secret:e.target.value}),className:"w-full px-4 py-3 border border-gray-300 rounded-lg font-mono",dir:"ltr"})]}),(0,a.jsxs)("div",{className:"md:col-span-2",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Base URL"}),a.jsx("input",{type:"url",value:m.base_url||"https://test.api.amadeus.com",onChange:e=>p({...m,base_url:e.target.value}),className:"w-full px-4 py-3 border border-gray-300 rounded-lg font-mono",dir:"ltr"})]})]}),a.jsx("h4",{className:"font-bold mt-4",children:"تفعيل / تعطيل الخدمات"}),a.jsx("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-3",children:[{key:"flights_enabled",label:"✈️ الرحلات"},{key:"hotels_enabled",label:"\uD83C\uDFE8 الفنادق"},{key:"transfers_enabled",label:"\uD83D\uDE97 النقل"},{key:"activities_enabled",label:"\uD83C\uDFAF الأنشطة"},{key:"analytics_enabled",label:"\uD83D\uDCCA التحليلات"}].map(({key:e,label:s})=>(0,a.jsxs)("label",{className:"flex items-center gap-2 p-3 bg-gray-50 rounded-lg cursor-pointer",children:[a.jsx("input",{type:"checkbox",checked:!1!==m[e],onChange:s=>p({...m,[e]:s.target.checked}),className:"rounded text-blue-600"}),a.jsx("span",{className:"text-sm",children:s})]},e))}),a.jsx("button",{onClick:w,className:"px-8 py-3 bg-gray-900 text-white font-bold rounded-lg hover:bg-gray-800",children:"\uD83D\uDCBE حفظ الإعدادات"})]})]})]})}},7863:(e,s,t)=>{"use strict";function a(e,s="SAR"){let t="string"==typeof e?parseFloat(e):e;return new Intl.NumberFormat("ar-SA",{style:"currency",currency:s,minimumFractionDigits:0,maximumFractionDigits:2}).format(t)}function r(e){let s=e.match(/PT(?:(\d+)H)?(?:(\d+)M)?/);if(!s)return e;let t=s[1]?`${s[1]}س`:"",a=s[2]?`${s[2]}د`:"";return`${t} ${a}`.trim()}function l(e){return new Date(e).toLocaleTimeString("ar-SA",{hour:"2-digit",minute:"2-digit",hour12:!1})}function i(e){return 0===e?"مباشر":1===e?"توقف واحد":2===e?"توقفان":`${e} توقفات`}function d(e,s){return e.length<=s?e:e.substring(0,s)+"..."}t.d(s,{$G:()=>d,LU:()=>r,T4:()=>a,iP:()=>i,mr:()=>l})},8748:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>a});let a=(0,t(8570).createProxy)(String.raw`C:\Users\ishou\Desktop\MashroukGit\Tmahshruk\CleanMashroky\amadeus-api\app\admin\page.tsx#default`)},1506:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>i,metadata:()=>l});var a=t(9510);t(7272);var r=t(7371);let l={title:"مشروك — حجز الرحلات والفنادق",description:"منصة حجز السفر المتكاملة — رحلات، فنادق، نقل، أنشطة"};function i({children:e}){return a.jsx("html",{lang:"ar",dir:"rtl",children:(0,a.jsxs)("body",{className:"antialiased",children:[a.jsx("nav",{className:"bg-white border-b shadow-sm sticky top-0 z-50",children:(0,a.jsxs)("div",{className:"max-w-7xl mx-auto px-4 flex items-center justify-between h-16",children:[a.jsx(r.default,{href:"/",className:"text-xl font-bold text-blue-700",children:"✈️ مشروك"}),(0,a.jsxs)("div",{className:"flex items-center gap-6",children:[a.jsx(r.default,{href:"/flights",className:"text-gray-600 hover:text-blue-700 font-medium",children:"الرحلات"}),a.jsx(r.default,{href:"/hotels",className:"text-gray-600 hover:text-amber-700 font-medium",children:"الفنادق"}),a.jsx(r.default,{href:"/transfers",className:"text-gray-600 hover:text-emerald-700 font-medium",children:"النقل"}),a.jsx(r.default,{href:"/activities",className:"text-gray-600 hover:text-purple-700 font-medium",children:"الأنشطة"}),a.jsx(r.default,{href:"/admin",className:"text-gray-400 hover:text-gray-600 text-sm",children:"الإدارة"})]})]})}),e]})})}},7272:()=>{}};var s=require("../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),a=s.X(0,[276,707],()=>t(875));module.exports=a})();