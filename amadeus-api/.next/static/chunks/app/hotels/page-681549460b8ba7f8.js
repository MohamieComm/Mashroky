(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[887],{5521:function(e,t,r){Promise.resolve().then(r.bind(r,4573))},4573:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return l}});var a=r(7437),n=r(2265),s=r(7855),o=r(4508);let i={ROOM_ONLY:"غرفة فقط",BREAKFAST:"إفطار",HALF_BOARD:"نصف إقامة",FULL_BOARD:"إقامة كاملة",ALL_INCLUSIVE:"شامل الجميع"};function l(){var e,t;let[r,l]=(0,n.useState)("search"),[c,d]=(0,n.useState)(!1),[u,m]=(0,n.useState)(""),[h,x]=(0,n.useState)(""),[f,g]=(0,n.useState)(""),[b,p]=(0,n.useState)(""),[y,v]=(0,n.useState)(1),[N,j]=(0,n.useState)(1),[w,S]=(0,n.useState)([]),[T,C]=(0,n.useState)([]),[k,O]=(0,n.useState)(null),[D,I]=(0,n.useState)(null),[R,A]=(0,n.useState)({firstName:"",lastName:""}),[L,P]=(0,n.useState)(""),[E,_]=(0,n.useState)(""),U=async e=>{if(e.preventDefault(),h){d(!0),m("");try{let e=await s.rT.searchByCity({cityCode:h});S(e.data||[]),l("hotels")}catch(e){m(e.message)}finally{d(!1)}}},F=async e=>{d(!0),m("");try{let t=await s.rT.searchOffers({hotelIds:e.slice(0,20),adults:y,checkInDate:f,checkOutDate:b,roomQuantity:N,currency:"SAR",bestRateOnly:!0});C(t.data||[]),l("offers")}catch(e){m(e.message)}finally{d(!1)}},J=async e=>{if(e.preventDefault(),k){d(!0),m("");try{let e=await s.rT.book({data:{type:"hotel-order",guests:[{tid:1,title:"MR",firstName:R.firstName,lastName:R.lastName,phone:E,email:L}],roomAssociations:[{guestReferences:[{guestReference:"1"}],hotelOfferId:k.offer.id}],payment:{method:"CREDIT_CARD",paymentCard:{paymentCardInfo:{vendorCode:"VI",holderName:"".concat(R.firstName," ").concat(R.lastName),cardNumber:"4111111111111111",expiryDate:"2026-12"}}}}});I(e),l("confirmation")}catch(e){m(e.message)}finally{d(!1)}}};return(0,a.jsxs)("div",{className:"min-h-screen bg-gradient-to-b from-amber-50 to-white",dir:"rtl",children:[(0,a.jsx)("div",{className:"bg-gradient-to-l from-amber-900 to-amber-700 text-white py-12 px-4",children:(0,a.jsxs)("div",{className:"max-w-5xl mx-auto text-center",children:[(0,a.jsx)("h1",{className:"text-4xl font-bold mb-2",children:"\uD83C\uDFE8 حجز الفنادق"}),(0,a.jsx)("p",{className:"text-amber-200 text-lg",children:"أفضل الفنادق في وجهتك المفضلة"})]})}),(0,a.jsxs)("div",{className:"max-w-5xl mx-auto px-4 -mt-8 pb-12",children:[u&&(0,a.jsxs)("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-xl text-red-700 text-center",children:["⚠️ ",u]}),"search"===r&&(0,a.jsxs)("form",{onSubmit:U,className:"bg-white rounded-2xl shadow-xl p-6 space-y-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"رمز المدينة (IATA)"}),(0,a.jsx)("input",{type:"text",required:!0,maxLength:3,value:h,onChange:e=>x(e.target.value.toUpperCase()),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-amber-500 text-center font-mono text-xl",placeholder:"RUH",dir:"ltr"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"عدد الغرف"}),(0,a.jsx)("select",{value:N,onChange:e=>j(parseInt(e.target.value)),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-amber-500",children:[1,2,3,4,5].map(e=>(0,a.jsx)("option",{value:e,children:e},e))})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"تاريخ الدخول"}),(0,a.jsx)("input",{type:"date",required:!0,value:f,onChange:e=>g(e.target.value),min:new Date().toISOString().split("T")[0],className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-amber-500"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"تاريخ الخروج"}),(0,a.jsx)("input",{type:"date",required:!0,value:b,onChange:e=>p(e.target.value),min:f||new Date().toISOString().split("T")[0],className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-amber-500"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"عدد البالغين"}),(0,a.jsx)("select",{value:y,onChange:e=>v(parseInt(e.target.value)),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-amber-500",children:[1,2,3,4].map(e=>(0,a.jsx)("option",{value:e,children:e},e))})]})]}),(0,a.jsx)("button",{type:"submit",disabled:c,className:"w-full py-4 bg-gradient-to-l from-amber-600 to-amber-700 text-white font-bold rounded-xl hover:from-amber-700 hover:to-amber-800 disabled:opacity-50 transition-all text-lg",children:c?"جاري البحث...":"\uD83D\uDD0D بحث عن فنادق"})]}),"hotels"===r&&(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("button",{onClick:()=>l("search"),className:"text-amber-700 hover:text-amber-900",children:"→ تعديل البحث"}),(0,a.jsxs)("h2",{className:"text-xl font-bold",children:[w.length," فندق متاح في ",h]})]}),(0,a.jsx)("button",{onClick:()=>F(w.map(e=>e.hotelId)),disabled:c,className:"w-full py-3 bg-amber-600 text-white rounded-lg hover:bg-amber-700 disabled:opacity-50",children:c?"جاري تحميل الأسعار...":"\uD83D\uDCB0 عرض الأسعار لجميع الفنادق"}),(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:w.slice(0,40).map(e=>(0,a.jsxs)("div",{className:"bg-white rounded-xl shadow-md p-4 hover:shadow-lg transition-shadow",children:[(0,a.jsx)("h3",{className:"font-bold text-lg mb-1",children:e.name||e.hotelId}),(0,a.jsxs)("div",{className:"text-sm text-gray-500 mb-2",children:[e.geoCode&&"".concat(e.geoCode.latitude.toFixed(3),", ").concat(e.geoCode.longitude.toFixed(3)),e.distance&&" — ".concat(e.distance.value," ").concat(e.distance.unit)]}),(0,a.jsxs)("div",{className:"text-xs text-gray-400",children:["ID: ",e.hotelId,e.chainCode&&" | سلسلة: ".concat(e.chainCode)]})]},e.hotelId))})]}),"offers"===r&&(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("button",{onClick:()=>l("hotels"),className:"text-amber-700 hover:text-amber-900",children:"→ رجوع لقائمة الفنادق"}),0===T.length?(0,a.jsx)("div",{className:"text-center py-12 bg-white rounded-xl shadow",children:(0,a.jsx)("p",{className:"text-xl text-gray-600",children:"لا تتوفر عروض الأسعار حالياً"})}):T.map(e=>{var t;return(0,a.jsxs)("div",{className:"bg-white rounded-xl shadow-md overflow-hidden",children:[(0,a.jsx)("div",{className:"p-4 bg-amber-50 border-b",children:(0,a.jsx)("h3",{className:"font-bold text-lg",children:e.hotel.name||e.hotel.hotelId})}),null===(t=e.offers)||void 0===t?void 0:t.map(t=>{var r,n,s;return(0,a.jsxs)("div",{className:"p-4 border-b last:border-b-0 flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-medium",children:(null===(r=t.room.typeEstimated)||void 0===r?void 0:r.category)||"غرفة قياسية"}),(0,a.jsx)("div",{className:"text-sm text-gray-500",children:null===(s=t.room.description)||void 0===s?void 0:null===(n=s.text)||void 0===n?void 0:n.substring(0,80)}),t.boardType&&(0,a.jsx)("span",{className:"inline-block mt-1 text-xs bg-green-100 text-green-700 px-2 py-0.5 rounded",children:i[t.boardType]||t.boardType})]}),(0,a.jsxs)("div",{className:"text-left",children:[(0,a.jsx)("div",{className:"text-xl font-bold text-amber-700",children:(0,o.T4)(t.price.total||"0",t.price.currency||"SAR")}),(0,a.jsx)("button",{onClick:()=>{O({hotel:e.hotel,offer:t}),l("booking")},className:"mt-2 px-4 py-2 bg-amber-600 text-white text-sm rounded-lg hover:bg-amber-700",children:"احجز الآن"})]})]},t.id)})]},e.hotel.hotelId)})]}),"booking"===r&&k&&(0,a.jsxs)("form",{onSubmit:J,className:"bg-white rounded-2xl shadow-xl p-6 space-y-6",children:[(0,a.jsx)("button",{type:"button",onClick:()=>l("offers"),className:"text-amber-700 hover:text-amber-900",children:"→ رجوع"}),(0,a.jsxs)("div",{className:"p-4 bg-amber-50 rounded-lg",children:[(0,a.jsx)("h3",{className:"font-bold",children:k.hotel.name}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:null===(e=k.offer.room.typeEstimated)||void 0===e?void 0:e.category}),(0,a.jsx)("p",{className:"text-xl font-bold text-amber-700 mt-2",children:(0,o.T4)(k.offer.price.total||"0",k.offer.price.currency||"SAR")})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"الاسم الأول"}),(0,a.jsx)("input",{type:"text",required:!0,value:R.firstName,onChange:e=>A(t=>({...t,firstName:e.target.value})),className:"w-full px-4 py-3 border border-gray-300 rounded-lg"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"اسم العائلة"}),(0,a.jsx)("input",{type:"text",required:!0,value:R.lastName,onChange:e=>A(t=>({...t,lastName:e.target.value})),className:"w-full px-4 py-3 border border-gray-300 rounded-lg"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"البريد الإلكتروني"}),(0,a.jsx)("input",{type:"email",required:!0,value:L,onChange:e=>P(e.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg",dir:"ltr"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"رقم الجوال"}),(0,a.jsx)("input",{type:"tel",required:!0,value:E,onChange:e=>_(e.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg",dir:"ltr"})]})]}),(0,a.jsx)("button",{type:"submit",disabled:c,className:"w-full py-4 bg-gradient-to-l from-green-600 to-green-700 text-white font-bold rounded-xl disabled:opacity-50",children:c?"جاري الحجز...":"✅ تأكيد حجز الفندق"})]}),"confirmation"===r&&D&&(0,a.jsxs)("div",{className:"bg-white rounded-2xl shadow-xl p-8 text-center",children:[(0,a.jsx)("div",{className:"text-6xl mb-4",children:"\uD83C\uDF89"}),(0,a.jsx)("h2",{className:"text-2xl font-bold text-green-700 mb-2",children:"تم حجز الفندق بنجاح!"}),(0,a.jsxs)("p",{className:"text-gray-600",children:["رقم الحجز: ",(0,a.jsx)("span",{className:"font-mono font-bold",children:(null===(t=D.data)||void 0===t?void 0:t.id)||"N/A"})]}),(0,a.jsx)("button",{onClick:()=>{l("search"),I(null)},className:"mt-8 px-8 py-3 bg-amber-600 text-white rounded-lg hover:bg-amber-700",children:"بحث جديد"})]})]})]})}},7855:function(e,t,r){"use strict";r.d(t,{cl:function(){return s},kO:function(){return i},rT:function(){return o},vt:function(){return c},z4:function(){return l}});let a=r(257).env.NEXT_PUBLIC_APP_URL||"";async function n(e,t){let r=await fetch("".concat(a).concat(e),{...t,headers:{"Content-Type":"application/json",...null==t?void 0:t.headers}});if(!r.ok)throw Error((await r.json().catch(()=>({error:r.statusText}))).error||"API Error: ".concat(r.status));return r.json()}let s={search:e=>n("/api/flights/search",{method:"POST",body:JSON.stringify(e)}),pricing:e=>n("/api/flights/pricing",{method:"POST",body:JSON.stringify(e)}),book:e=>n("/api/flights/book",{method:"POST",body:JSON.stringify(e)}),getOrder:e=>n("/api/flights/orders/".concat(e)),cancelOrder:e=>n("/api/flights/orders/".concat(e),{method:"DELETE"}),status:e=>{let t=new URLSearchParams(e).toString();return n("/api/flights/status?".concat(t))},seatMaps:e=>n("/api/flights/seatmaps",{method:"POST",body:JSON.stringify(e)}),cheapestDates:e=>{let t=new URLSearchParams(e).toString();return n("/api/flights/cheapest-dates?".concat(t))}},o={searchByCity:e=>{let t=new URLSearchParams(e).toString();return n("/api/hotels/search?".concat(t))},searchOffers:e=>n("/api/hotels/offers",{method:"POST",body:JSON.stringify(e)}),autocomplete:e=>n("/api/hotels/autocomplete?keyword=".concat(encodeURIComponent(e))),book:e=>n("/api/hotels/book",{method:"POST",body:JSON.stringify(e)})},i={search:e=>n("/api/transfers/search",{method:"POST",body:JSON.stringify(e)}),book:e=>n("/api/transfers/book",{method:"POST",body:JSON.stringify(e)}),cancel:e=>n("/api/transfers/cancel",{method:"POST",body:JSON.stringify(e)})},l={search:e=>{let t=new URLSearchParams(e).toString();return n("/api/activities/search?".concat(t))},get:e=>n("/api/activities/".concat(e))},c={search:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"AIRPORT,CITY";return n("/api/locations?keyword=".concat(encodeURIComponent(e),"&subType=").concat(t))},airlines:e=>n("/api/airlines".concat(e?"?airlineCodes=".concat(e):""))}},4508:function(e,t,r){"use strict";function a(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"SAR",r="string"==typeof e?parseFloat(e):e;return new Intl.NumberFormat("ar-SA",{style:"currency",currency:t,minimumFractionDigits:0,maximumFractionDigits:2}).format(r)}function n(e){let t=e.match(/PT(?:(\d+)H)?(?:(\d+)M)?/);if(!t)return e;let r=t[1]?"".concat(t[1],"س"):"",a=t[2]?"".concat(t[2],"د"):"";return"".concat(r," ").concat(a).trim()}function s(e){return new Date(e).toLocaleTimeString("ar-SA",{hour:"2-digit",minute:"2-digit",hour12:!1})}function o(e){return 0===e?"مباشر":1===e?"توقف واحد":2===e?"توقفان":"".concat(e," توقفات")}function i(e,t){return e.length<=t?e:e.substring(0,t)+"..."}r.d(t,{$G:function(){return i},LU:function(){return n},T4:function(){return a},iP:function(){return o},mr:function(){return s}})},257:function(e,t,r){"use strict";var a,n;e.exports=(null==(a=r.g.process)?void 0:a.env)&&"object"==typeof(null==(n=r.g.process)?void 0:n.env)?r.g.process:r(4227)},4227:function(e){!function(){var t={229:function(e){var t,r,a,n=e.exports={};function s(){throw Error("setTimeout has not been defined")}function o(){throw Error("clearTimeout has not been defined")}function i(e){if(t===setTimeout)return setTimeout(e,0);if((t===s||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(r){try{return t.call(null,e,0)}catch(r){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:s}catch(e){t=s}try{r="function"==typeof clearTimeout?clearTimeout:o}catch(e){r=o}}();var l=[],c=!1,d=-1;function u(){c&&a&&(c=!1,a.length?l=a.concat(l):d=-1,l.length&&m())}function m(){if(!c){var e=i(u);c=!0;for(var t=l.length;t;){for(a=l,l=[];++d<t;)a&&a[d].run();d=-1,t=l.length}a=null,c=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===o||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function h(e,t){this.fun=e,this.array=t}function x(){}n.nextTick=function(e){var t=Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];l.push(new h(e,t)),1!==l.length||c||i(m)},h.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={},n.on=x,n.addListener=x,n.once=x,n.off=x,n.removeListener=x,n.removeAllListeners=x,n.emit=x,n.prependListener=x,n.prependOnceListener=x,n.listeners=function(e){return[]},n.binding=function(e){throw Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(e){throw Error("process.chdir is not supported")},n.umask=function(){return 0}}},r={};function a(e){var n=r[e];if(void 0!==n)return n.exports;var s=r[e]={exports:{}},o=!0;try{t[e](s,s.exports,a),o=!1}finally{o&&delete r[e]}return s.exports}a.ab="//";var n=a(229);e.exports=n}()}},function(e){e.O(0,[971,117,744],function(){return e(e.s=5521)}),_N_E=e.O()}]);